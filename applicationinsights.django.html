


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>applicationinsights.django module &#8212; Application Insights SDK for Python 0.12.0 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/overrides.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="applicationinsights.exceptions module" href="applicationinsights.exceptions.html" />
    <link rel="prev" title="applicationinsights.requests module" href="applicationinsights.requests.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="applicationinsights.exceptions.html" title="applicationinsights.exceptions module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="applicationinsights.requests.html" title="applicationinsights.requests module"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Application Insights SDK for Python 0.12.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="applicationinsights.html" accesskey="U">applicationinsights module</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="applicationinsights-django-module">
<h1>applicationinsights.django module<a class="headerlink" href="#applicationinsights-django-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="applicationinsightsmiddleware-class">
<h2>ApplicationInsightsMiddleware class<a class="headerlink" href="#applicationinsightsmiddleware-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="applicationinsights.django.ApplicationInsightsMiddleware">
<em class="property">class </em><code class="sig-prename descclassname">applicationinsights.django.</code><code class="sig-name descname">ApplicationInsightsMiddleware</code><span class="sig-paren">(</span><em class="sig-param">get_response=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/applicationinsights/django/middleware.html#ApplicationInsightsMiddleware"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#applicationinsights.django.ApplicationInsightsMiddleware" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is a Django middleware that automatically enables request and exception telemetry.  Django versions
1.7 and newer are supported.</p>
<p>To enable, add this class to your settings.py file in MIDDLEWARE_CLASSES (pre-1.10) or MIDDLEWARE (1.10 and newer):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># If on Django &lt; 1.10</span>
<span class="n">MIDDLEWARE_CLASSES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ... or whatever is below for you ...</span>
    <span class="s1">&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.middleware.common.CommonMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth.middleware.SessionAuthenticationMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class="p">,</span>
    <span class="c1"># ... or whatever is above for you ...</span>
    <span class="s1">&#39;applicationinsights.django.ApplicationInsightsMiddleware&#39;</span><span class="p">,</span>   <span class="c1"># Add this middleware to the end</span>
<span class="p">]</span>

<span class="c1"># If on Django &gt;= 1.10</span>
<span class="n">MIDDLEWARE</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ... or whatever is below for you ...</span>
    <span class="s1">&#39;django.middleware.security.SecurityMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions.middleware.SessionMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.middleware.common.CommonMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.middleware.csrf.CsrfViewMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth.middleware.AuthenticationMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages.middleware.MessageMiddleware&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.middleware.clickjacking.XFrameOptionsMiddleware&#39;</span><span class="p">,</span>
    <span class="c1"># ... or whatever is above for you ...</span>
    <span class="s1">&#39;applicationinsights.django.ApplicationInsightsMiddleware&#39;</span><span class="p">,</span>   <span class="c1"># Add this middleware to the end</span>
<span class="p">]</span>
</pre></div>
</div>
<p>And then, add the following to your settings.py file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">APPLICATION_INSIGHTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># (required) Your Application Insights instrumentation key</span>
    <span class="s1">&#39;ikey&#39;</span><span class="p">:</span> <span class="s2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="p">,</span>

    <span class="c1"># (optional) By default, request names are logged as the request method</span>
    <span class="c1"># and relative path of the URL.  To log the fully-qualified view names</span>
    <span class="c1"># instead, set this to True.  Defaults to False.</span>
    <span class="s1">&#39;use_view_name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>

    <span class="c1"># (optional) To log arguments passed into the views as custom properties,</span>
    <span class="c1"># set this to True.  Defaults to False.</span>
    <span class="s1">&#39;record_view_arguments&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>

    <span class="c1"># (optional) Exceptions are logged by default, to disable, set this to False.</span>
    <span class="s1">&#39;log_exceptions&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>

    <span class="c1"># (optional) Events are submitted to Application Insights asynchronously.</span>
    <span class="c1"># send_interval specifies how often the queue is checked for items to submit.</span>
    <span class="c1"># send_time specifies how long the sender waits for new input before recycling</span>
    <span class="c1"># the background thread.</span>
    <span class="s1">&#39;send_interval&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="c1"># Check every second</span>
    <span class="s1">&#39;send_time&#39;</span><span class="p">:</span> <span class="mf">3.0</span><span class="p">,</span> <span class="c1"># Wait up to 3 seconds for an event</span>

    <span class="c1"># (optional, uncommon) If you must send to an endpoint other than the</span>
    <span class="c1"># default endpoint, specify it here:</span>
    <span class="s1">&#39;endpoint&#39;</span><span class="p">:</span> <span class="s2">&quot;https://dc.services.visualstudio.com/v2/track&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Once these are in place, each request will have an <cite>appinsights</cite> object placed on it.
This object will have the following properties:</p>
<ul class="simple">
<li><p><cite>client</cite>: This is an instance of the <a class="reference internal" href="applicationinsights.html#applicationinsights.TelemetryClient" title="applicationinsights.TelemetryClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">applicationinsights.TelemetryClient</span></code></a> type, which will
submit telemetry to the same instrumentation key, and will parent each telemetry item to the current
request.</p></li>
<li><p><cite>request</cite>: This is the <a class="reference internal" href="applicationinsights.channel.contracts.html#applicationinsights.channel.contracts.RequestData" title="applicationinsights.channel.contracts.RequestData"><code class="xref py py-class docutils literal notranslate"><span class="pre">applicationinsights.channel.contracts.RequestData</span></code></a> instance for the
current request.  You can modify properties on this object during the handling of the current request.
It will be submitted when the request has finished.</p></li>
<li><p><cite>context</cite>: This is the <a class="reference internal" href="applicationinsights.channel.html#applicationinsights.channel.TelemetryContext" title="applicationinsights.channel.TelemetryContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">applicationinsights.channel.TelemetryContext</span></code></a> object for the current
ApplicationInsights sender.</p></li>
</ul>
<p>These properties will be present even when <cite>DEBUG</cite> is <cite>True</cite>, but it may not submit telemetry unless
<cite>debug_ikey</cite> is set in <cite>APPLICATION_INSIGHTS</cite>, above.</p>
</dd></dl>

</div>
<div class="section" id="logginghandler-class">
<h2>LoggingHandler class<a class="headerlink" href="#logginghandler-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="applicationinsights.django.LoggingHandler">
<em class="property">class </em><code class="sig-prename descclassname">applicationinsights.django.</code><code class="sig-name descname">LoggingHandler</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/applicationinsights/django/logging.html#LoggingHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#applicationinsights.django.LoggingHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is a LoggingHandler that uses the same settings as the Django middleware to configure
the telemetry client.  This can be referenced from LOGGING in your Django settings.py file.  As an
example, this code would send all Django log messages–WARNING and up–to Application Insights:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">LOGGING</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;disable_existing_loggers&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># The application insights handler is here</span>
        <span class="s1">&#39;appinsights&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;applicationinsights.django.LoggingHandler&#39;</span><span class="p">,</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;WARNING&#39;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;loggers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;django&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;handlers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;appinsights&#39;</span><span class="p">],</span>
            <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">,</span>
            <span class="s1">&#39;propagate&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># You will need this anyway if you&#39;re using the middleware.</span>
<span class="c1"># See the middleware documentation for more information on configuring</span>
<span class="c1"># this setting:</span>
<span class="n">APPLICATION_INSIGHTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ikey&#39;</span><span class="p">:</span> <span class="s1">&#39;00000000-0000-0000-0000-000000000000&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="create-client-function">
<h2>create_client function<a class="headerlink" href="#create-client-function" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="applicationinsights.django.create_client">
<code class="sig-prename descclassname">applicationinsights.django.</code><code class="sig-name descname">create_client</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/applicationinsights/django.html#create_client"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#applicationinsights.django.create_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an <a class="reference internal" href="applicationinsights.html#applicationinsights.TelemetryClient" title="applicationinsights.TelemetryClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">applicationinsights.TelemetryClient</span></code></a> instance using the instrumentation key
and other settings found in the current Django project’s <cite>settings.py</cite> file.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">applicationinsights.django module</a><ul>
<li><a class="reference internal" href="#applicationinsightsmiddleware-class">ApplicationInsightsMiddleware class</a></li>
<li><a class="reference internal" href="#logginghandler-class">LoggingHandler class</a></li>
<li><a class="reference internal" href="#create-client-function">create_client function</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="applicationinsights.requests.html"
                        title="previous chapter">applicationinsights.requests module</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="applicationinsights.exceptions.html"
                        title="next chapter">applicationinsights.exceptions module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/applicationinsights.django.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="applicationinsights.exceptions.html" title="applicationinsights.exceptions module"
             >next</a> |</li>
        <li class="right" >
          <a href="applicationinsights.requests.html" title="applicationinsights.requests module"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Application Insights SDK for Python 0.12.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="applicationinsights.html" >applicationinsights module</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Max Brenner.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.3.
    </div>
  </body>
</html>