


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>applicationinsights.TelemetryClient &#8212; Application Insights SDK for Python 0.12.0 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/overrides.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Application Insights SDK for Python 0.12.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for applicationinsights.TelemetryClient</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">uuid</span>


<span class="kn">from</span> <span class="nn">applicationinsights</span> <span class="kn">import</span> <span class="n">channel</span>

<span class="n">NULL_CONSTANT_STRING</span> <span class="o">=</span> <span class="s1">&#39;Null&#39;</span>


<div class="viewcode-block" id="TelemetryClient"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient">[docs]</a><span class="k">class</span> <span class="nc">TelemetryClient</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The telemetry client used for sending all types of telemetry. It serves as the main entry point for</span>
<span class="sd">    interacting with the Application Insights service.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instrumentation_key</span><span class="p">,</span> <span class="n">telemetry_channel</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initializes a new instance of the class.</span>

<span class="sd">        Args:</span>
<span class="sd">            instrumentation_key (str). the instrumentation key to use for this telemetry client.\n</span>
<span class="sd">            telemetry_channel (:class:`channel.TelemetryChannel`). the optional telemetry channel to be used instead of</span>
<span class="sd">                constructing a default one.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">instrumentation_key</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">instrumentation_key</span><span class="p">,</span> <span class="n">channel</span><span class="o">.</span><span class="n">TelemetryChannel</span><span class="p">):</span>
                <span class="n">telemetry_channel</span> <span class="o">=</span> <span class="n">instrumentation_key</span>
                <span class="n">instrumentation_key</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s1">&#39;Instrumentation key was required but not provided&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">TelemetryContext</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">instrumentation_key</span> <span class="o">=</span> <span class="n">instrumentation_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span> <span class="o">=</span> <span class="n">telemetry_channel</span> <span class="ow">or</span> <span class="n">channel</span><span class="o">.</span><span class="n">TelemetryChannel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_telemetry_processors</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The context associated with this client. All data objects created by this client will be accompanied by</span>
<span class="sd">        this value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`channel.TelemetryContext`. the context instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">channel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The channel associated with this telemetry client. All data created by this client will be passed along with</span>
<span class="sd">        the :func:`context` object to :class:`channel.TelemetryChannel`&#39;s :func:`write`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :class:`channel.TelemetryChannel`. the channel instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span>

<div class="viewcode-block" id="TelemetryClient.flush"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.flush">[docs]</a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Flushes data in the queue. Data in the queue will be sent either immediately irrespective of what sender is</span>
<span class="sd">        being used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span></div>

<div class="viewcode-block" id="TelemetryClient.track_pageview"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.track_pageview">[docs]</a>    <span class="k">def</span> <span class="nf">track_pageview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">measurements</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send information about the page viewed in the application (a web page for instance).</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str). the name of the page that was viewed.\n</span>
<span class="sd">            url (str). the URL of the page that was viewed.\n</span>
<span class="sd">            duration (int). the duration of the page view in milliseconds. (defaults to: 0)\n</span>
<span class="sd">            properties (dict). the set of custom properties the client wants attached to this data item. (defaults to: None)\n</span>
<span class="sd">            measurements (dict). the set of custom measurements the client wants to attach to this data item. (defaults to: None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">PageViewData</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">NULL_CONSTANT_STRING</span>
        <span class="n">data</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
        <span class="n">data</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">duration</span>
        <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span>
        <span class="k">if</span> <span class="n">measurements</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="n">measurements</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">)</span></div>

<div class="viewcode-block" id="TelemetryClient.track_exception"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.track_exception">[docs]</a>    <span class="k">def</span> <span class="nf">track_exception</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tb</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">measurements</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Send information about a single exception that occurred in the application.</span>

<span class="sd">        Args:</span>
<span class="sd">            type (Type). the type of the exception that was thrown.\n</span>
<span class="sd">            value (:class:`Exception`). the exception that the client wants to send.\n</span>
<span class="sd">            tb (:class:`Traceback`). the traceback information as returned by :func:`sys.exc_info`.\n</span>
<span class="sd">            properties (dict). the set of custom properties the client wants attached to this data item. (defaults to: None)\n</span>
<span class="sd">            measurements (dict). the set of custom measurements the client wants to attach to this data item. (defaults to: None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">tb</span><span class="p">:</span>
            <span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tb</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">value</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">tb</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">NULL_CONSTANT_STRING</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">tb</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span>

        <span class="n">details</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">ExceptionDetails</span><span class="p">()</span>
        <span class="n">details</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">details</span><span class="o">.</span><span class="n">outer_id</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">details</span><span class="o">.</span><span class="n">type_name</span> <span class="o">=</span> <span class="nb">type</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">details</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">details</span><span class="o">.</span><span class="n">has_full_stack</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">tb_frame_file</span><span class="p">,</span> <span class="n">tb_frame_line</span><span class="p">,</span> <span class="n">tb_frame_function</span><span class="p">,</span> <span class="n">tb_frame_text</span> <span class="ow">in</span> <span class="n">traceback</span><span class="o">.</span><span class="n">extract_tb</span><span class="p">(</span><span class="n">tb</span><span class="p">):</span>
            <span class="n">frame</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">StackFrame</span><span class="p">()</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">assembly</span> <span class="o">=</span> <span class="s1">&#39;Unknown&#39;</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">file_name</span> <span class="o">=</span> <span class="n">tb_frame_file</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">counter</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">line</span> <span class="o">=</span> <span class="n">tb_frame_line</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">tb_frame_function</span>
            <span class="n">details</span><span class="o">.</span><span class="n">parsed_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">details</span><span class="o">.</span><span class="n">parsed_stack</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">ExceptionData</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">handled_at</span> <span class="o">=</span> <span class="s1">&#39;UserCode&#39;</span>
        <span class="n">data</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">details</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span>
        <span class="k">if</span> <span class="n">measurements</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="n">measurements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">)</span></div>

<div class="viewcode-block" id="TelemetryClient.track_event"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.track_event">[docs]</a>    <span class="k">def</span> <span class="nf">track_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">measurements</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Send information about a single event that has occurred in the context of the application.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str). the data to associate to this event.\n</span>
<span class="sd">            properties (dict). the set of custom properties the client wants attached to this data item. (defaults to: None)\n</span>
<span class="sd">            measurements (dict). the set of custom measurements the client wants to attach to this data item. (defaults to: None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">EventData</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">NULL_CONSTANT_STRING</span>
        <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span>
        <span class="k">if</span> <span class="n">measurements</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="n">measurements</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">)</span></div>

<div class="viewcode-block" id="TelemetryClient.track_metric"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.track_metric">[docs]</a>    <span class="k">def</span> <span class="nf">track_metric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">std_dev</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Send information about a single metric data point that was captured for the application.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str). the name of the metric that was captured.\n</span>
<span class="sd">            value (float). the value of the metric that was captured.\n</span>
<span class="sd">            type (:class:`channel.contracts.DataPointType`). the type of the metric. (defaults to: :func:`channel.contracts.DataPointType.aggregation`)\n</span>
<span class="sd">            count (int). the number of metrics that were aggregated into this data point. (defaults to: None)\n</span>
<span class="sd">            min (float). the minimum of all metrics collected that were aggregated into this data point. (defaults to: None)\n</span>
<span class="sd">            max (float). the maximum of all metrics collected that were aggregated into this data point. (defaults to: None)\n</span>
<span class="sd">            std_dev (float). the standard deviation of all metrics collected that were aggregated into this data point. (defaults to: None)\n</span>
<span class="sd">            properties (dict). the set of custom properties the client wants attached to this data item. (defaults to: None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dataPoint</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">DataPoint</span><span class="p">()</span>
        <span class="n">dataPoint</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">NULL_CONSTANT_STRING</span>
        <span class="n">dataPoint</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">dataPoint</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="nb">type</span> <span class="ow">or</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">DataPointType</span><span class="o">.</span><span class="n">aggregation</span>
        <span class="n">dataPoint</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span>
        <span class="n">dataPoint</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="nb">min</span>
        <span class="n">dataPoint</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="nb">max</span>
        <span class="n">dataPoint</span><span class="o">.</span><span class="n">std_dev</span> <span class="o">=</span> <span class="n">std_dev</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">MetricData</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataPoint</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">)</span></div>

<div class="viewcode-block" id="TelemetryClient.track_trace"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.track_trace">[docs]</a>    <span class="k">def</span> <span class="nf">track_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a single trace statement.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str). the trace statement.\n</span>
<span class="sd">            properties (dict). the set of custom properties the client wants attached to this data item. (defaults to: None)\n</span>
<span class="sd">            severity (str). the severity level of this trace, one of DEBUG, INFO, WARNING, ERROR, CRITICAL</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">MessageData</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="n">NULL_CONSTANT_STRING</span>
        <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span>
        <span class="k">if</span> <span class="n">severity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">severity_level</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">MessageData</span><span class="o">.</span><span class="n">PYTHON_LOGGING_LEVELS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">severity</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">)</span></div>

<div class="viewcode-block" id="TelemetryClient.track_request"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.track_request">[docs]</a>    <span class="k">def</span> <span class="nf">track_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">response_code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">http_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">measurements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">request_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a single request that was captured for the application.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str). the name for this request. All requests with the same name will be grouped together.\n</span>
<span class="sd">            url (str). the actual URL for this request (to show in individual request instances).\n</span>
<span class="sd">            success (bool). true if the request ended in success, false otherwise.\n</span>
<span class="sd">            start_time (str). the start time of the request. The value should look the same as the one returned by :func:`datetime.isoformat()` (defaults to: None)\n</span>
<span class="sd">            duration (int). the number of milliseconds that this request lasted. (defaults to: None)\n</span>
<span class="sd">            response_code (str). the response code that this request returned. (defaults to: None)\n</span>
<span class="sd">            http_method (str). the HTTP method that triggered this request. (defaults to: None)\n</span>
<span class="sd">            properties (dict). the set of custom properties the client wants attached to this data item. (defaults to: None)\n</span>
<span class="sd">            measurements (dict). the set of custom measurements the client wants to attach to this data item. (defaults to: None)\n</span>
<span class="sd">            request_id (str). the id for this request. If None, a new uuid will be generated. (defaults to: None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">RequestData</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">request_id</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="n">data</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">data</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
        <span class="n">data</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="n">success</span>
        <span class="n">data</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">start_time</span> <span class="ow">or</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;Z&#39;</span>
        <span class="n">data</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ms_to_duration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">response_code</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">response_code</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;200&#39;</span>
        <span class="n">data</span><span class="o">.</span><span class="n">http_method</span> <span class="o">=</span> <span class="n">http_method</span> <span class="ow">or</span> <span class="s1">&#39;GET&#39;</span>
        <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span>
        <span class="k">if</span> <span class="n">measurements</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="n">measurements</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">)</span></div>

<div class="viewcode-block" id="TelemetryClient.track_dependency"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.track_dependency">[docs]</a>    <span class="k">def</span> <span class="nf">track_dependency</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">success</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">result_code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">measurements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dependency_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a single dependency telemetry that was captured for the application.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str). the name of the command initiated with this dependency call. Low cardinality value. Examples are stored procedure name and URL path template.\n</span>
<span class="sd">            data (str). the command initiated by this dependency call. Examples are SQL statement and HTTP URL with all query parameters.\n</span>
<span class="sd">            type (str). the dependency type name. Low cardinality value for logical grouping of dependencies and interpretation of other fields like commandName and resultCode. Examples are SQL, Azure table, and HTTP. (default to: None)\n</span>
<span class="sd">            target (str). the target site of a dependency call. Examples are server name, host address. (default to: None)\n</span>
<span class="sd">            duration (int). the number of milliseconds that this dependency call lasted. (defaults to: None)\n</span>
<span class="sd">            success (bool). true if the dependency call ended in success, false otherwise. (defaults to: None)\n</span>
<span class="sd">            result_code (str). the result code of a dependency call. Examples are SQL error code and HTTP status code. (defaults to: None)\n</span>
<span class="sd">            properties (dict). the set of custom properties the client wants attached to this data item. (defaults to: None)\n</span>
<span class="sd">            measurements (dict). the set of custom measurements the client wants to attach to this data item. (defaults to: None)\n</span>
<span class="sd">            id (str). the id for this dependency call. If None, a new uuid will be generated. (defaults to: None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dependency_data</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">RemoteDependencyData</span><span class="p">()</span>
        <span class="n">dependency_data</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">dependency_id</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="n">dependency_data</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">dependency_data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">dependency_data</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="n">dependency_data</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span>
        <span class="n">dependency_data</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__ms_to_duration</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
        <span class="n">dependency_data</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="n">success</span>
        <span class="n">dependency_data</span><span class="o">.</span><span class="n">result_code</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result_code</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;200&#39;</span>
        <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">dependency_data</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span>
        <span class="k">if</span> <span class="n">measurements</span><span class="p">:</span>
            <span class="n">dependency_data</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="n">measurements</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">dependency_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">)</span></div>

<div class="viewcode-block" id="TelemetryClient.track_availability"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.track_availability">[docs]</a>    <span class="k">def</span> <span class="nf">track_availability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">success</span><span class="p">,</span> <span class="n">run_location</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">measurements</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">availability_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sends a single availability telemetry that was captured for the application.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str). the name of the command initiated with this dependency call. Low cardinality value. Examples are stored procedure name and URL path template.\n</span>
<span class="sd">            duration (int). the number of milliseconds that this dependency call lasted.\n</span>
<span class="sd">            success (bool). true if the dependency call ended in success, false otherwise.\n</span>
<span class="sd">            run_location (str). the name of the location where the test has been executed.\n</span>
<span class="sd">            message (str). the message for this availability telemetry. (defaults to: None)\n</span>
<span class="sd">            properties (dict). the set of custom properties the client wants attached to this data item. (defaults to: None)\n</span>
<span class="sd">            measurements (dict). the set of custom measurements the client wants to attach to this data item. (defaults to: None)\n</span>
<span class="sd">            id (str). the id for this dependency call. If None, a new uuid will be generated. (defaults to: None)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">availability_data</span> <span class="o">=</span> <span class="n">channel</span><span class="o">.</span><span class="n">contracts</span><span class="o">.</span><span class="n">AvailabilityData</span><span class="p">()</span>
        <span class="n">availability_data</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">availability_id</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="n">availability_data</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">availability_data</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">duration</span>
        <span class="n">availability_data</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="n">success</span>
        <span class="n">availability_data</span><span class="o">.</span><span class="n">run_location</span> <span class="o">=</span> <span class="n">run_location</span>
        <span class="n">availability_data</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
            <span class="n">availability_data</span><span class="o">.</span><span class="n">properties</span> <span class="o">=</span> <span class="n">properties</span>
        <span class="k">if</span> <span class="n">measurements</span><span class="p">:</span>
            <span class="n">availability_data</span><span class="o">.</span><span class="n">measurements</span> <span class="o">=</span> <span class="n">measurements</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">availability_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_telemetry_processors</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">channel</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

<div class="viewcode-block" id="TelemetryClient.add_telemetry_processor"><a class="viewcode-back" href="../../applicationinsights.html#applicationinsights.TelemetryClient.add_telemetry_processor">[docs]</a>    <span class="k">def</span> <span class="nf">add_telemetry_processor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">telemetry_processor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds telemetry processor to the collection. Telemetry processors will be called one by one</span>
<span class="sd">           before telemetry item is pushed for sending and in the order they were added.</span>

<span class="sd">        Args:</span>
<span class="sd">            telemetry_processor (function). Takes a telemetry item, and context object and returns boolean </span>
<span class="sd">                                            that determines if the event is passed to the server (False = Filtered)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">telemetry_processor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;telemetry_processor cannot be None.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_telemetry_processors</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">telemetry_processor</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">run_telemetry_processors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">allow_data_through</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">processor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_telemetry_processors</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">processor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">allow_data_through</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">allow_data_through</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">allow_data_through</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__ms_to_duration</span><span class="p">(</span><span class="n">duration_ms</span><span class="p">):</span>
        <span class="n">local_duration</span> <span class="o">=</span> <span class="n">duration_ms</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="n">duration_parts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">multiplier</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">24</span><span class="p">]:</span>
            <span class="n">duration_parts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">local_duration</span> <span class="o">%</span> <span class="n">multiplier</span><span class="p">)</span>
            <span class="n">local_duration</span> <span class="o">//=</span> <span class="n">multiplier</span>

        <span class="n">duration_parts</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%02d</span><span class="s1">:</span><span class="si">%02d</span><span class="s1">:</span><span class="si">%02d</span><span class="s1">.</span><span class="si">%03d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">duration_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">duration_parts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">duration_parts</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">duration_parts</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">local_duration</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">local_duration</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">duration</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Application Insights SDK for Python 0.12.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Max Brenner.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.
    </div>
  </body>
</html>